<%- include('../layouts/header')%>
<%- include('../partials/admin-header')%>

<style>
.success-message {
    display: none;
    color: green;
    background-color: #dff0d8; /* Use a background color for success messages */
    border: 1px solid #d6e9c6; /* Use a border for success messages */
    padding: 10px; /* Add padding for better visibility */
  }

  .error-message {
    display: none;
    color: red;
    background-color: #f2dede; /* Use a background color for error messages */
    border: 1px solid #ebccd1; /* Use a border for error messages */
    padding: 10px; /* Add padding for better visibility */
  }
  </style>
  
<div class="header" style="margin-top: 80px;">
    <h1>Add Category</h1>
  </div>
  <%- include('../partials/admin-canvas')%>
<div class="container-fluid">
    <div class="row  border-start">
        <main class="px-md-4 icons " style="margin-left: 18%;width: 80%; margin-top: 6%;">
            <div class="row d-flex justify-content-between">
                <div class="col-md-8">
                    <h1 class="mt-5">ADD CATEGORY</h1>
                    <% if (error && error.length > 0) { %>
                        <div class="error-message">
                          <%= error %>
                        </div>
                      <% } %>
                      
                      <!-- Display success message -->
                      <% if (success && success.length > 0) { %>
                        <div class="success-message">
                          <%= success %>
                        </div>
                      <% } %>
                    <form action="/admin/addcategory" method="post" enctype="multipart/form-data" class="bg-white" onsubmit="return validateForm()">
                        <div class="form-group">
                            <label for="categoryname">Category Name:</label>
                            <input
                                type="text"
                                name="Name"
                                class="form-control bg-light"
                                id="categoryName"
                                placeholder="Enter Category name"
                                required
                            />
                        </div><br><br>
                        Image:
                        <div class="border p-3 mb-3 bg-light "> <!-- Added bg-light and text-center classes -->
                            <h3>Media</h3>
                            <div class="form-group text-center">
                                <label for="categoryImage">Drag and drop or click to upload an image:</label>
                                <br><br><br><br>
                                <input
                                type="file"
                                name="image"
                                class="form-control-file text-center"
                                id="categoryImage"
                                accept="image/*"
                                onchange="previewImage()"
                                multiple
                                style="display: none;"
                             
                            />
                            </div>
                            <br>
                            <!-- uploaded images -->
                            <div class="text-center">
                                <img src="" alt="Uploaded Image" id="uploadedImage" class="img-fluid" style="max-height: 200px;">
                                <button onclick="return confirm('Are you sure you want to delete the image')" class="btn btn-danger btn-sm deletes-image" style="display: none;">Delete</button>
                              </div>
                        </div>
                    
                        
                        <button type="submit" class="btn btn-primary ms-3">Add Category</button>
                    </form>
                </div>
            </div>
        </main>
    </div>
</div>

<script>
  function previewImage() {
        const input = document.getElementById('categoryImage');
        const preview = document.getElementById('uploadedImage');
        const deleteButton = document.querySelector('.deletes-image');

        const file = input.files[0];

        if (file) {
            const reader = new FileReader();

            reader.onload = function (e) {
                preview.src = e.target.result;
                preview.style.display = 'block';
                deleteButton.style.display = 'block';
            };

            reader.readAsDataURL(file);
        } else {
            preview.src = '';
            preview.style.display = 'none';
            deleteButton.style.display = 'none';
        }
    }

    function validateForm() {
    const name = document.getElementById('Name').value; // Replace 'Name' with the actual ID of your name input
    const image = document.getElementById('Image').value; // Replace 'Image' with the actual ID of your image input

    if (!name || !image) {
      alert('Both Name and Image are required for category update.');
      return false; // Prevent form submission
    }

    return true; // Allow form submission if validation passes
  }
  const errorBox = document.querySelector('.error-message');
        const successBox = document.querySelector('.success-message');
    
        if ("<%= error %>") {
          errorBox.style.display = 'block';
        }
    
        if ("<%= success %>") {
          successBox.style.display = 'block';
        }

    </script>

<%- include('../layouts/footer') %>